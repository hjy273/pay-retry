# Pay-Retry 流程

## 目的

真实项目中使用的支付流程，主要流程如下



### 后台支付流程



点击支付 

||

多线程遍历购物车列表

||

多线程遍历单个购物车中的商品列表

||

遍历兑换商品（进入第三方兑换流程）

||

更新订单与购物车

||

结束



### 第三方兑换流程

兑换/扣点/邮件均使用第三方接口，包含兑换失败重试机制，机制为最多 10 秒重试 3 次，重试中包含兑换与检验第三方订单两个 API，根据返回结果调用相关 API，重试流程图如下（简化后）：

![支付流程](https://github.com/liujinnaoheliugawa/pay-retry/blob/master/src/main/resources/支付流程.jpg)
